<launch>
    <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [burger, waffle, waffle_pi]"/>
    <!-- @ REQUIRED @ nome del robot e spawn position -->
    <arg name="robot_name" />
    <arg name="x_pos" />
    <arg name="y_pos" />
    <arg name="z_pos" />

    <!--tbot bringup-->
    <include file="$(find learning_multirobot)/launch/includes/turtlebot3_remote.launch">
		<arg name="model" value="$(arg model)"/>
        <arg name="multi_robot_name" value="$(arg robot_name)" />
	</include>

    <!--spawner-->
	<node name="spawn_urdf" pkg="gazebo_ros" type="spawn_model"
          args="-urdf -model $(arg robot_name) -x $(arg x_pos) -y $(arg y_pos) -z $(arg z_pos)
          -param robot_description"
    />

    <!--AMCL -->
    <node pkg="amcl" type="amcl" name="amcl" args="scan:=scan">
        <remap from="static_map" to="/static_map" />
        <param name="initial_pose_x" value="$(arg x_pos)" />
        <param name="initial_pose_y" value="$(arg y_pos)" />
        <param name="global_frame_id" value="map" />
        <param name="odom_frame_id" value="$(arg robot_name)/odom" />
        <param name="base_frame_id" value="$(arg robot_name)/base_link" />
    </node>

    <node pkg="move_base" type="move_base" name="move_base" >
        <param name="base_local_planner" value="dwa_local_planner/DWAPlannerROS" />

        <!--<rosparam file="$(find learning_navigation)/param/costmap_common_params_$(arg model).yaml" command="load" />-->
        <rosparam file="$(find learning_multirobot)/param/costmap_common_params_$(arg model).yaml" command="load" ns="global_costmap" />
        <rosparam file="$(find learning_multirobot)/param/costmap_common_params_$(arg model).yaml" command="load" ns="local_costmap" />
		<rosparam file="$(find learning_multirobot)/param/local_costmap_params.yaml" command="load" />
		<rosparam file="$(find learning_multirobot)/param/global_costmap_params.yaml" command="load" />
		<rosparam file="$(find learning_multirobot)/param/dwa_local_planner_params_$(arg model).yaml" command="load" />
		<rosparam file="$(find learning_multirobot)/param/move_base_params.yaml" command="load" />
	</node>
</launch>