<launch>
    <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [burger, waffle, waffle_pi]"/>
    <!-- @ REQUIRED @ robot name (same as namespace) and spawn position -->
    <arg name="robot_name" />
    <arg name="x_pos" />
    <arg name="y_pos" />
    <arg name="z_pos" />

    <param name="tf_prefix" value="$(arg robot_name)" />

    <!-- tbot bringup -->
    <include file="$(find learning_multirobot)/launch/includes/turtlebot3_remote.launch">
		<arg name="model" value="$(arg model)"/>
        <arg name="multi_robot_name" value="$(arg robot_name)" />
	</include>

    <!-- spawner -->
	<node name="spawn_urdf" pkg="gazebo_ros" type="spawn_model"
          args="-urdf -model $(arg robot_name)
          -x $(arg x_pos) -y $(arg y_pos) -z $(arg z_pos)
          -param robot_description">
        <remap from="joint_states" to="/$(arg robot_name)/joint_states" />
        <remap from="scan" to="/$(arg robot_name)/scan" />
        <remap from="cmd_vel" to="/$(arg robot_name)/cmd_vel" />
    </node>

    <!--gmapping-->
    <include file="$(find learning_multirobot)/launch/includes/gmapping_multirobot.launch">
        <arg name="robot_name" value="$(arg robot_name)" />
    </include>

    <!-- world frame publisher -->
    <node pkg="learning_multirobot" type="world_frame.py" name="world_tf_publisher" args="$(arg robot_name)/map" />

    <!--map merge-->
    <node pkg="map_merge_3d" type="map_merge_node" name="map_merge">
        <param name="robot_map_topic" value="$(arg robot_name)/map" />
        <param name="robot_namespace" value="$(arg robot_name)" />
        <param name="merged_map_topic" value="/map" />
        <param name="world_frame" value="/world_frame" />
        <!--<param name="" value="$(arg robot_name)/" />-->
    </node>

    <!-- move base -->
    <!--<include file="$(find learning_multirobot)/launch/includes/move_base_multirobot.launch">-->
    <!--    <arg name="robot_name" value="$(arg robot_name)" />-->
    <!--    <arg name="model" value="$(arg model)" />-->
    <!--</include>-->
</launch>